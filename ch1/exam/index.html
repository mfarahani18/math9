<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>آزمون ریاضی نهم - فصل اول: مجموعه‌ها</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet" type="text/css" />
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Indigo & Violet Theme */
            --primary-dark: #4338ca;   /* Indigo 700 */
            --primary-main: #6366f1;   /* Indigo 500 */
            --primary-light: #e0e7ff;  /* Indigo 100 */
            --secondary-main: #8b5cf6; /* Violet 500 */
            --accent: #f59e0b;         /* Amber 500 */
            --text-main: #1e293b;      /* Slate 800 */
            --bg-paper: #ffffff;
            --correct: #10b981;        /* Emerald 500 */
            --wrong: #ef4444;          /* Red 500 */
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f8fafc;
            background-image: radial-gradient(#cbd5e1 1.5px, transparent 1.5px);
            background-size: 24px 24px;
            margin: 0;
            padding: 0;
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- Header & Footer --- */
        .header-graphic {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--secondary-main) 100%);
            position: relative;
            color: white;
            padding-bottom: 60px;
            overflow: hidden;
            box-shadow: 0 10px 30px -10px rgba(99, 102, 241, 0.5);
            border-bottom-left-radius: 30px;
            border-bottom-right-radius: 30px;
        }
        .header-wave {
            position: absolute; bottom: 0; left: 0; width: 100%; height: auto;
            color: #f8fafc; fill: currentColor; z-index: 2;
            opacity: 0.1;
        }
        
        .footer-strip {
            background: #ffffff;
            margin-top: auto;
            border-top: 1px solid #e2e8f0;
            box-shadow: 0 -4px 20px rgba(0,0,0,0.02);
        }

        /* --- Math & Numbers --- */
        .math-ltr {
            direction: ltr;
            display: inline-block;
            unicode-bidi: embed;
            font-family: 'Times New Roman', serif;
            font-weight: bold;
        }
        .persian-num {
            font-feature-settings: "ss01";
        }

        /* --- Fraction Style --- */
        .fraction {
            display: inline-block;
            vertical-align: middle;
            text-align: center;
            margin: 0 4px;
            font-size: 0.95em;
            font-weight: bold;
        }
        .fraction .numerator {
            display: block;
            border-bottom: 2px solid currentColor;
            padding-bottom: 1px;
            line-height: 1;
        }
        .fraction .denominator {
            display: block;
            padding-top: 1px;
            line-height: 1;
        }

        /* --- Quiz Container --- */
        .quiz-container {
            max-width: 850px;
            margin: -40px auto 40px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(12px);
            border-radius: 24px;
            box-shadow: 0 20px 50px -12px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.8);
            position: relative;
            z-index: 10;
            padding: 40px;
            min-height: 480px;
        }

        /* --- Quiz Elements --- */
        .question-card {
            display: none;
            animation: fadeIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .question-card.active { display: block; }

        .option-btn {
            width: 100%;
            text-align: right;
            padding: 18px 24px;
            margin-bottom: 14px;
            border: 2px solid transparent;
            border-radius: 16px;
            background: #f1f5f9;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            font-size: 1.05rem;
            position: relative;
            display: flex;
            align-items: center;
        }
        .option-btn:hover {
            background: #eef2ff;
            border-color: var(--primary-light);
            transform: translateX(-4px);
        }
        .option-btn.selected {
            border-color: var(--primary-main);
            background: #e0e7ff;
            color: var(--primary-dark);
            font-weight: 700;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }
        /* Styles for review mode */
        .option-btn.review-correct {
            border-color: var(--correct);
            background: #ecfdf5;
            color: #065f46;
        }
        .option-btn.review-wrong {
            border-color: var(--wrong);
            background: #fef2f2;
            color: #991b1b;
        }

        .hint-box {
            background: #fffbeb;
            border-left: 4px solid var(--accent);
            padding: 16px;
            margin-top: 24px;
            border-radius: 8px;
            font-size: 0.95rem;
            color: #92400e;
            display: none;
            animation: slideDown 0.3s ease-out;
            box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-main), var(--secondary-main));
            color: white;
            padding: 14px 36px;
            border-radius: 14px;
            font-weight: bold;
            font-size: 1.1rem;
            transition: 0.3s;
            box-shadow: 0 8px 20px -4px rgba(99, 102, 241, 0.4);
            letter-spacing: 0.5px;
        }
        .btn-primary:hover { 
            transform: translateY(-3px) scale(1.02); 
            box-shadow: 0 12px 25px -5px rgba(99, 102, 241, 0.5);
        }
        .btn-primary:disabled {
            background: #cbd5e1;
            box-shadow: none;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: white;
            color: var(--text-main);
            border: 2px solid #e2e8f0;
            padding: 12px 28px;
            border-radius: 14px;
            font-weight: bold;
            transition: 0.3s;
        }
        .btn-secondary:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }
        .btn-secondary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-outline {
            border: 2px solid var(--primary-main);
            color: var(--primary-main);
            padding: 12px 30px;
            border-radius: 14px;
            font-weight: bold;
            background: transparent;
            transition: 0.2s;
        }
        .btn-outline:hover { 
            background: var(--primary-light);
            color: var(--primary-dark);
        }

        /* --- Animations --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideDown { from { opacity: 0; height: 0; transform: translateY(-5px); } to { opacity: 1; height: auto; transform: translateY(0); } }
        @keyframes floatUp { 0% { transform: translateY(0) scale(1); opacity: 0.8; } 100% { transform: translateY(-25px) scale(1.2); opacity: 0; } }
        
        .steam text { animation: floatUp 3.5s infinite ease-out; opacity: 0; }
        .steam text:nth-child(1) { animation-delay: 0s; }
        .steam text:nth-child(2) { animation-delay: 1.5s; }
        .steam text:nth-child(3) { animation-delay: 0.5s; }
        
        /* --- Results --- */
        .review-item {
            border: 1px solid #f1f5f9;
            padding: 24px;
            border-radius: 20px;
            margin-bottom: 20px;
            background: #fff;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.02);
            transition: transform 0.2s;
        }
        .review-item:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05); }
        
        .badge {
            display: inline-block;
            padding: 6px 14px;
            border-radius: 99px;
            font-size: 0.8rem;
            font-weight: 800;
            margin-left: 10px;
        }
        .badge-correct { background: #d1fae5; color: #047857; }
        .badge-wrong { background: #fee2e2; color: #b91c1c; }

    </style>
</head>
<body>

    <!-- Header -->
    <header class="header-graphic pt-4 px-4 relative no-print">
        <div class="relative z-10 w-full h-auto py-4 max-w-6xl mx-auto flex flex-col items-center justify-center gap-3">
            
            <div class="flex items-center gap-4 bg-white/10 backdrop-blur-md px-8 py-3 rounded-2xl border border-white/20 shadow-lg">
                <!-- Logo -->
                <div class="w-16 h-16 flex items-center justify-center filter drop-shadow-xl shrink-0">
                    <svg viewBox="0 0 100 100" width="70" height="70" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M75 45 Q 95 45 95 60 Q 95 75 75 75" fill="none" stroke="white" stroke-width="4" stroke-linecap="round"/>
                        <path d="M20 40 Q 20 95 50 95 Q 80 95 80 40" fill="white" stroke="white" stroke-width="2"/>
                        <line x1="15" y1="95" x2="85" y2="95" stroke="white" stroke-width="3" stroke-linecap="round"/>
                        <g class="steam">
                            <text x="40" y="36" font-family="sans-serif" font-size="12" fill="white" font-weight="bold">+</text>
                            <text x="60" y="36" font-family="serif" font-size="12" fill="white" font-weight="bold">√</text>
                            <text x="50" y="28" font-family="serif" font-size="14" fill="white" font-weight="bold">π</text>
                        </g>
                        <text x="50" y="70" font-family="'Dancing Script', cursive" font-size="12" fill="#4338ca" text-anchor="middle" font-weight="bold">Math Cafe</text>
                    </svg>
                </div>

                <!-- Title & Subtitle -->
                <div class="text-center">
                    <h1 class="text-4xl font-black tracking-tight text-white drop-shadow-lg mb-1" style="text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                        کافه ریاضی
                    </h1>
                    <div class="flex items-center justify-center gap-2">
                        <span class="h-px w-8 bg-white/50"></span>
                        <span class="text-indigo-100 text-sm font-bold tracking-wide">آزمون آنلاین - فصل اول: مجموعه‌ها</span>
                        <span class="h-px w-8 bg-white/50"></span>
                    </div>
                </div>
            </div>

        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow px-4 w-full max-w-4xl mx-auto">
        
        <!-- Start Screen -->
        <div id="start-screen" class="quiz-container flex flex-col items-center justify-center text-center">
            <div class="mb-8 bg-gradient-to-tr from-indigo-50 to-violet-50 p-8 rounded-full shadow-inner ring-4 ring-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-24 w-24 text-primary-main transform rotate-12" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                </svg>
            </div>
            <h2 class="text-4xl font-black text-slate-800 mb-6 tracking-tight">آزمون جامع فصل اول</h2>
            <div class="bg-indigo-50 px-6 py-4 rounded-2xl mb-8 border border-indigo-100">
                <p class="text-slate-700 leading-8 text-lg max-w-lg font-medium">
                    این آزمون شامل ۲۰ سؤال چهارگزینه‌ای از مباحث: <br>
                    <span class="text-primary-main">مجموعه‌ها، زیرمجموعه، اعمال روی مجموعه‌ها و احتمال</span> است.
                </p>
                <div class="mt-3 text-sm text-slate-500 flex items-center justify-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" /></svg>
                    هر بار سؤالات به صورت تصادفی انتخاب می‌شوند.
                </div>
            </div>
            <button onclick="startQuiz()" class="btn-primary text-xl px-12 py-4">شروع آزمون</button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="quiz-container hidden">
            <div class="flex justify-between items-end mb-8 border-b border-slate-100 pb-6">
                <div class="flex flex-col">
                    <span class="text-slate-400 text-xs font-bold mb-2 uppercase tracking-wider">پیشرفت آزمون</span>
                    <span class="text-slate-800 font-black text-2xl flex items-baseline gap-2">
                        سؤال <span id="current-q-num" class="text-primary-main text-3xl">۱</span> 
                        <span class="text-base text-slate-400 font-medium">از ۲۰</span>
                    </span>
                </div>
                <!-- Green Progress Bar -->
                <div class="w-1/2 bg-slate-100 rounded-full h-4 overflow-hidden shadow-inner p-1">
                    <div id="progress-bar" class="bg-gradient-to-l from-green-400 to-emerald-600 h-full rounded-full transition-all duration-500 ease-out shadow-sm" style="width: 0%"></div>
                </div>
            </div>

            <div id="question-container">
                <!-- Question content will be injected here -->
            </div>

            <div class="flex justify-between items-center mt-12 pt-6 border-t border-slate-100 flex-wrap gap-4">
                <div class="flex gap-2 w-full sm:w-auto justify-between sm:justify-start">
                    <button id="prev-btn" onclick="prevQuestion()" class="btn-secondary disabled:opacity-50" disabled>
                        سؤال قبلی
                    </button>
                    <button onclick="toggleHint()" class="flex items-center gap-2 text-amber-600 font-bold hover:text-amber-700 transition bg-amber-50 px-5 py-2.5 rounded-xl hover:bg-amber-100 border border-amber-200">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span class="hidden sm:inline">راهنما</span>
                    </button>
                </div>
                
                <button id="next-btn" onclick="nextQuestion()" class="btn-primary w-full sm:w-auto" disabled>
                    سؤال بعدی
                </button>
            </div>
        </div>

        <!-- Result Screen -->
        <div id="result-screen" class="quiz-container hidden text-center">
            <div class="mb-8 animate-bounce inline-block p-6 bg-white rounded-full shadow-xl ring-8 ring-indigo-50">
                <svg id="score-icon" xmlns="http://www.w3.org/2000/svg" class="h-20 w-20 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <!-- Icon injected by JS -->
                </svg>
            </div>
            <h2 class="text-3xl font-black text-slate-800 mb-2">نتیجه نهایی آزمون</h2>
            
            <div class="bg-slate-50 rounded-3xl p-8 mb-8 inline-block border border-slate-200 shadow-sm min-w-[250px]">
                <span class="block text-slate-500 font-bold mb-2 text-sm">نمره شما</span>
                <!-- Fixed Score Display (Solid color for visibility) -->
                <div class="text-7xl font-black text-indigo-600 pers-num leading-tight" style="direction: ltr;" id="final-score"></div>
            </div>
            
            <p id="score-msg" class="text-slate-600 mb-12 text-xl font-bold"></p>
            
            <div class="flex gap-4 justify-center flex-wrap">
                <button onclick="showReview()" class="btn-outline border-2 px-8">بررسی دقیق پاسخ‌نامه</button>
                <button onclick="resetAndRestart()" class="btn-primary px-8">آزمون مجدد</button>
            </div>
        </div>

        <!-- Review Screen -->
        <div id="review-screen" class="quiz-container hidden">
            <div class="flex items-center justify-between mb-8 border-b border-slate-200 pb-6">
                <h2 class="text-2xl font-black text-slate-800 flex items-center gap-3">
                    <div class="bg-primary-light p-2 rounded-lg text-primary-main">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                        </svg>
                    </div>
                    پاسخ‌نامه تشریحی
                </h2>
                <button onclick="backToResult()" class="text-sm font-bold text-slate-500 hover:text-primary-main transition">بازگشت به نتایج</button>
            </div>

            <div id="review-container" class="space-y-6">
                <!-- Review items injected here -->
            </div>
            <div class="mt-12 text-center pt-6 border-t border-slate-200">
                <button onclick="resetAndRestart()" class="btn-primary px-10">آزمون مجدد</button>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="footer-strip w-full px-6 py-6 mt-auto relative z-20">
        <div class="flex flex-col md:flex-row items-center justify-between text-slate-700 w-full max-w-5xl mx-auto gap-6">
            
            <!-- Designer Text (Right in RTL) -->
            <div class="font-bold text-slate-500 text-sm flex items-center gap-2 bg-slate-50 px-4 py-2 rounded-full border border-slate-200">
                <span class="w-2 h-2 rounded-full bg-secondary-main"></span>
                طراح: استاد فراهانی
            </div>

            <!-- Channel Link Group (Left in RTL) -->
            <div class="flex items-center gap-4">
                <div class="text-left text-xs text-slate-400 hidden md:block leading-relaxed">
                    <p class="font-bold text-slate-500">آدرس کانال ما در ایتا، روبیکا، بله و سروش:</p>
                    <p class="opacity-80">(با کلیک روی آدرس به کانال ما بپیوندید)</p>
                </div>
                
                <!-- Link Button -->
                <a href="https://eitaa.com/math_cafe" target="_blank" class="flex items-center gap-3 bg-white hover:bg-indigo-50 px-5 py-2.5 rounded-2xl border border-slate-200 hover:border-indigo-300 transition-all shadow-sm hover:shadow-md text-decoration-none group transform hover:-translate-y-1">
                    <span class="font-black text-lg dir-ltr text-indigo-600 font-sans tracking-tight">math_cafe@</span>
                    <div class="w-8 h-8 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                        </svg>
                    </div>
                </a>
            </div>

        </div>
    </footer>

    <script>
        // --- Helper for Fractions ---
        const frac = (n, d) => `<span class="fraction"><span class="numerator">${n}</span><span class="denominator">${d}</span></span>`;

        // --- Question Pool (100 Questions) ---
        const questionPool = [
            // Lesson 1: Introduction to Sets
            {
                q: "کدام گزینه یک «مجموعه» را مشخص می‌کند؟",
                options: ["چهار عدد فرد متوالی", "سه شاعر بزرگ ایران", "اعداد طبیعی بین ۲ و ۳", "تعدادی از اعداد اول"],
                correct: 2,
                hint: "مجموعه باید کاملاً مشخص و معین باشد و هیچ ابهامی نداشته باشد.",
                rationale: "گزینه ۳ تنها موردی است که اعضای آن دقیقاً مشخص هستند (مجموعه تهی). سایر گزینه‌ها دارای ابهام هستند."
            },
            {
                q: "عبارت «اعداد اول یک رقمی» کدام مجموعه را مشخص می‌کند؟",
                options: ["<span class='math-ltr'>{۱, ۳, ۵, ۷}</span>", "<span class='math-ltr'>{۲, ۳, ۵, ۷}</span>", "<span class='math-ltr'>{۳, ۵, ۷, ۹}</span>", "<span class='math-ltr'>{۱, ۲, ۳, ۵}</span>"],
                correct: 1,
                hint: "اعداد اول اعدادی هستند که فقط بر یک و خودشان بخش‌پذیرند. عدد ۱ اول نیست.",
                rationale: "اعداد اول یک رقمی عبارتند از ۲، ۳، ۵ و ۷."
            },
            {
                q: "کدام عبارت یک مجموعه تهی را مشخص می‌کند؟",
                options: ["اعداد طبیعی بین ۴ و ۵", "عدد صفر", "مجموعه اعداد زوج", "اعداد اول زوج"],
                correct: 0,
                hint: "بین دو عدد طبیعی متوالی، هیچ عدد طبیعی دیگری وجود ندارد.",
                rationale: "بین ۴ و ۵ هیچ عدد طبیعی وجود ندارد، پس این مجموعه عضوی ندارد (تهی است)."
            },
            {
                q: "مجموعه <span class='math-ltr'>{ ∅ }</span> چند عضو دارد؟",
                options: ["۰", "۱", "۲", "بی‌شمار"],
                correct: 1,
                hint: "آیا داخل آکولاد چیزی وجود دارد؟",
                rationale: "این مجموعه دارای یک عضو است و آن عضو «مجموعه تهی» است."
            },
            {
                q: "تعداد اعضای مجموعه <span class='math-ltr'>A = {x | x ∈ ℕ, x < 1}</span> چند است؟",
                options: ["۰", "۱", "بی‌نهایت", "۲"],
                correct: 0,
                hint: "اولین عدد طبیعی ۱ است.",
                rationale: "هیچ عدد طبیعی کوچکتر از ۱ وجود ندارد. پس مجموعه تهی است و تعداد اعضای آن ۰ است."
            },
            {
                q: "با ارقام ۱، ۲ و ۳ چند عدد دو رقمی (بدون تکرار ارقام) می‌توان ساخت که عضو مجموعه‌ی جدید باشند؟",
                options: ["۳", "۶", "۹", "۲۷"],
                correct: 1,
                hint: "جایگشت ۲ از ۳.",
                rationale: "اعداد عبارتند از: ۱۲، ۱۳، ۲۱، ۲۳، ۳۱، ۳۲. (۶ عدد)"
            },
            {
                q: "اگر <span class='math-ltr'>A = {x ∈ ℤ | -۲ ≤ x < ۲}</span> باشد، اعضای آن کدامند؟",
                options: ["<span class='math-ltr'>{-۲, -۱, ۰, ۱, ۲}</span>", "<span class='math-ltr'>{-۲, -۱, ۰, ۱}</span>", "<span class='math-ltr'>{-۱, ۰, ۱}</span>", "<span class='math-ltr'>{-۱, ۰, ۱, ۲}</span>"],
                correct: 1,
                hint: "علامت مساوی زیر علامت کوچکتر را دقت کنید.",
                rationale: "چون -۲ مساوی دارد شامل می‌شود ولی ۲ مساوی ندارد."
            },
            {
                q: "نمایش اعضای مجموعه <span class='math-ltr'>{x ∈ ℤ | x² = 1}</span> کدام است؟",
                options: ["<span class='math-ltr'>{۱}</span>", "<span class='math-ltr'>{-۱}</span>", "<span class='math-ltr'>{۱, -۱}</span>", "<span class='math-ltr'>{۰, ۱}</span>"],
                correct: 2,
                hint: "چه اعدادی صحیح هستند که اگر به توان ۲ برسند، حاصل ۱ می‌شود؟",
                rationale: "هم ۱ و هم -۱ به توان دو برابر ۱ می‌شوند."
            },
            {
                q: "کدام مجموعه متناهی است؟",
                options: ["اعداد طبیعی", "اعداد صحیح", "بازه‌ی (۰, ۱)", "اعداد اول یک رقمی"],
                correct: 3,
                hint: "مجموعه‌ای که تعداد اعضای آن قابل شمارش و محدود باشد.",
                rationale: "اعداد اول یک رقمی {۲, ۳, ۵, ۷} هستند که ۴ عضو دارد."
            },
            {
                q: "مجموعه <span class='math-ltr'>{x | x ∈ ℕ, x + x = x}</span> چند عضو دارد؟",
                options: ["۰", "۱", "۲", "بی‌نهایت"],
                correct: 0,
                hint: "تنها عددی که دو برابرش با خودش برابر است صفر است.",
                rationale: "فقط عدد ۰ در این معادله صدق می‌کند، اما ۰ عدد طبیعی نیست. پس مجموعه تهی است."
            },
            {
                q: "کدام گزینه نادرست است؟",
                options: ["<span class='math-ltr'>∅ ⊆ {0}</span>", "<span class='math-ltr'>0 ∈ {0}</span>", "<span class='math-ltr'>{0} ⊆ {0, 1}</span>", "<span class='math-ltr'>0 ⊆ {0}</span>"],
                correct: 3,
                hint: "زیرمجموعه بودن بین دو مجموعه است، اما ۰ یک عضو است.",
                rationale: "۰ یک عضو است و نمی‌تواند زیرمجموعه باشد. باید نوشت <span class='math-ltr'>{0} ⊆ {0}</span>."
            },
            {
                q: "مجموعه <span class='math-ltr'>A = {1, {1}, {1, 2}}</span> چند عضو دارد؟",
                options: ["۴", "۳", "۲", "۵"],
                correct: 1,
                hint: "اعضا با ویرگول جدا می‌شوند.",
                rationale: "اعضا: ۱، {۱} و {۱, ۲}. (۳ عضو)"
            },
            {
                q: "کدام عبارت صحیح است؟",
                options: ["<span class='math-ltr'>1 ∈ {1, 2}</span>", "<span class='math-ltr'>{1} ∈ {1, 2}</span>", "<span class='math-ltr'>1 ⊆ {1, 2}</span>", "<span class='math-ltr'>{1, 2} ∈ {1, 2}</span>"],
                correct: 0,
                hint: "عضویت با نماد تعلق نشان داده می‌شود.",
                rationale: "عدد ۱ عضوی از مجموعه است."
            },
            {
                q: "نمایش هندسی بازه‌ی <span class='math-ltr'>{x ∈ ℝ | -1 < x ≤ 2}</span> چگونه است؟",
                options: ["دایره توپر روی -۱ و توخالی روی ۲", "دایره توخالی روی -۱ و توپر روی ۲", "هر دو توپر", "هر دو توخالی"],
                correct: 1,
                hint: "تساوی به معنی توپر بودن دایره است.",
                rationale: "-۱ مساوی ندارد (توخالی) و ۲ مساوی دارد (توپر)."
            },
            {
                q: "مجموعه <span class='math-ltr'>A = {x | 2x = 5, x ∈ ℤ}</span> چه نوع مجموعه‌ای است؟",
                options: ["تهی", "تک عضوی", "متناهی", "نامتناهی"],
                correct: 0,
                hint: "آیا ۲.۵ عدد صحیح است؟",
                rationale: "جواب معادله ۲.۵ است که صحیح نیست. پس مجموعه تهی است."
            },

            // Lesson 2: Subsets & Equal Sets
            {
                q: "تعداد زیرمجموعه‌های یک مجموعه ۵ عضوی چند است؟",
                options: ["۱۶", "۳۲", "۶۴", "۱۰"],
                correct: 1,
                hint: "فرمول <span class='math-ltr'>2<sup>n</sup></span>.",
                rationale: "<span class='math-ltr'>2<sup>5</sup> = 32</span>."
            },
            {
                q: "اگر <span class='math-ltr'>A ⊆ B</span> و <span class='math-ltr'>B ⊆ A</span> باشد، آنگاه:",
                options: ["<span class='math-ltr'>A = ∅</span>", "<span class='math-ltr'>A = B</span>", "<span class='math-ltr'>A ∩ B = ∅</span>", "هیچکدام"],
                correct: 1,
                hint: "دو مجموعه که زیرمجموعه یکدیگرند.",
                rationale: "طبق تعریف برابری مجموعه‌ها، <span class='math-ltr'>A = B</span>."
            },
            {
                q: "تعداد زیرمجموعه‌های محض (غیر از خود مجموعه) یک مجموعه ۴ عضوی؟",
                options: ["۱۵", "۱۶", "۱۴", "۸"],
                correct: 0,
                hint: "کل زیرمجموعه‌ها منهای ۱.",
                rationale: "<span class='math-ltr'>2<sup>4</sup> - 1 = 16 - 1 = 15</span>."
            },
            {
                q: "اگر تعداد زیرمجموعه‌های یک مجموعه ۶۴ باشد، تعداد اعضای آن چند است؟",
                options: ["۵", "۶", "۷", "۸"],
                correct: 1,
                hint: "۲ به توان چه عددی ۶۴ می‌شود؟",
                rationale: "<span class='math-ltr'>2<sup>6</sup> = 64</span>."
            },
            {
                q: "کدام گزینه زیرمجموعه تمام مجموعه‌ها است؟",
                options: ["<span class='math-ltr'>{0}</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>{1}</span>", "خود مجموعه"],
                correct: 1,
                hint: "مجموعه‌ای که هیچ عضوی ندارد.",
                rationale: "مجموعه تهی زیرمجموعه همه مجموعه‌هاست."
            },
            {
                q: "اگر <span class='math-ltr'>A = {a, b}</span>، تعداد زیرمجموعه‌های A چند است؟",
                options: ["۲", "۳", "۴", "۱"],
                correct: 2,
                hint: "<span class='math-ltr'>2<sup>2</sup></span>",
                rationale: "۴ زیرمجموعه دارد."
            },
            {
                q: "تعداد زیرمجموعه‌های مجموعه <span class='math-ltr'>{1, 2, 2, 3}</span> چقدر است؟",
                options: ["۱۶", "۸", "۴", "۳"],
                correct: 1,
                hint: "عضو تکراری حذف می‌شود.",
                rationale: "مجموعه اصلی ۳ عضو دارد ({1, 2, 3}). پس <span class='math-ltr'>2<sup>3</sup> = 8</span>."
            },
            {
                q: "اگر <span class='math-ltr'>A ⊆ B</span> و <span class='math-ltr'>B ⊆ C</span>، کدام درست است؟",
                options: ["<span class='math-ltr'>A ⊆ C</span>", "<span class='math-ltr'>C ⊆ A</span>", "<span class='math-ltr'>A ∩ C = ∅</span>", "<span class='math-ltr'>A = C</span>"],
                correct: 0,
                hint: "خاصیت تعدی.",
                rationale: "اگر A درون B و B درون C باشد، A درون C است."
            },
            {
                q: "دو مجموعه <span class='math-ltr'>{2, x}</span> و <span class='math-ltr'>{y, 3}</span> برابرند. مقدار <span class='math-ltr'>x+y</span> کدام است؟",
                options: ["۴", "۵", "۶", "۱"],
                correct: 1,
                hint: "اعضا باید نظیر به نظیر برابر باشند.",
                rationale: "<span class='math-ltr'>x=3</span> و <span class='math-ltr'>y=2</span>. جمع آنها ۵ است."
            },
            {
                q: "تعداد زیرمجموعه‌های مجموعه <span class='math-ltr'>A</span>، ۳۲ برابر تعداد زیرمجموعه‌های مجموعه <span class='math-ltr'>B</span> است. <span class='math-ltr'>n(A) - n(B)</span> چقدر است؟",
                options: ["۴", "۵", "۶", "۳۲"],
                correct: 1,
                hint: "<span class='math-ltr'>32 = 2<sup>5</sup></span>.",
                rationale: "اختلاف توان‌ها باید ۵ باشد."
            },
            {
                q: "مجموعه <span class='math-ltr'>{x | x ∈ N, 2x = 1}</span> چند زیرمجموعه دارد؟",
                options: ["۰", "۱", "۲", "۴"],
                correct: 1,
                hint: "ابتدا تعداد اعضا را بیابید.",
                rationale: "مجموعه تهی است (۰ عضو). تعداد زیرمجموعه <span class='math-ltr'>2<sup>0</sup> = 1</span>."
            },
            {
                q: "کدام گزینه صحیح است؟",
                options: ["<span class='math-ltr'>N ⊆ W ⊆ Z ⊆ Q</span>", "<span class='math-ltr'>Z ⊆ N</span>", "<span class='math-ltr'>Q ⊆ Z</span>", "<span class='math-ltr'>R ⊆ Q</span>"],
                correct: 0,
                hint: "ترتیب مجموعه‌های اعداد.",
                rationale: "طبیعی < حسابی < صحیح < گویا."
            },
            {
                q: "اگر <span class='math-ltr'>A = {{a}, b}</span> باشد، کدام نادرست است؟",
                options: ["<span class='math-ltr'>{a} ∈ A</span>", "<span class='math-ltr'>{{a}} ⊆ A</span>", "<span class='math-ltr'>a ⊆ A</span>", "<span class='math-ltr'>{b} ⊆ A</span>"],
                correct: 2,
                hint: "a یک عضو نیست، {a} عضو است.",
                rationale: "a به تنهایی در مجموعه نیست، بلکه {a} هست."
            },
            {
                q: "تعداد اعضای <span class='math-ltr'>P(A)</span> (مجموعه توانی) برای یک مجموعه ۳ عضوی؟",
                options: ["۳", "۶", "۸", "۹"],
                correct: 2,
                hint: "برابر تعداد زیرمجموعه‌هاست.",
                rationale: "۸ عضو."
            },
            {
                q: "اگر تعداد اعضای مجموعه‌ای ۳ واحد اضافه شود، تعداد زیرمجموعه‌هایش چند برابر می‌شود؟",
                options: ["۳", "۶", "۸", "۹"],
                correct: 2,
                hint: "<span class='math-ltr'>2<sup>n+3</sup> = 2<sup>n</sup> × 2<sup>3</sup></span>.",
                rationale: "<span class='math-ltr'>2<sup>3</sup> = 8</span> برابر."
            },

            // Lesson 3: Operations (Union, Intersection, Difference)
            {
                q: "اگر <span class='math-ltr'>A = {1, 2}</span> و <span class='math-ltr'>B = {2, 3}</span>، حاصل <span class='math-ltr'>A ∩ B</span> چیست؟",
                options: ["<span class='math-ltr'>{1}</span>", "<span class='math-ltr'>{2}</span>", "<span class='math-ltr'>{3}</span>", "<span class='math-ltr'>{1, 2, 3}</span>"],
                correct: 1,
                hint: "عضو مشترک.",
                rationale: "فقط ۲ مشترک است."
            },
            {
                q: "اگر <span class='math-ltr'>A ⊆ B</span> باشد، <span class='math-ltr'>A ∪ B</span> برابر است با:",
                options: ["<span class='math-ltr'>A</span>", "<span class='math-ltr'>B</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>A - B</span>"],
                correct: 1,
                hint: "اجتماع زیرمجموعه با مجموعه مرجع.",
                rationale: "برابر مجموعه بزرگتر (B) است."
            },
            {
                q: "حاصل <span class='math-ltr'>A - A</span> همیشه برابر است با:",
                options: ["<span class='math-ltr'>A</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>U</span>", "صفر"],
                correct: 1,
                hint: "حذف خود از خود.",
                rationale: "تهی می‌شود."
            },
            {
                q: "اگر <span class='math-ltr'>A ∩ B = ∅</span> باشد، <span class='math-ltr'>A - B</span> کدام است؟",
                options: ["<span class='math-ltr'>A</span>", "<span class='math-ltr'>B</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>B - A</span>"],
                correct: 0,
                hint: "چیزی برای حذف وجود ندارد.",
                rationale: "خود A باقی می‌ماند."
            },
            {
                q: "تفاضل <span class='math-ltr'>N - W</span> برابر است با:",
                options: ["<span class='math-ltr'>{0}</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>N</span>", "<span class='math-ltr'>W</span>"],
                correct: 1,
                hint: "تمام اعداد طبیعی حسابی هستند.",
                rationale: "چون N زیرمجموعه W است، حاصل تهی است."
            },
            {
                q: "حاصل <span class='math-ltr'>W - N</span> چیست؟",
                options: ["<span class='math-ltr'>{0}</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>N</span>", "<span class='math-ltr'>W</span>"],
                correct: 0,
                hint: "تنها تفاوت حسابی و طبیعی.",
                rationale: "عدد صفر."
            },
            {
                q: "کدام رابطه همواره درست است؟",
                options: ["<span class='math-ltr'>A ∪ B = B ∪ A</span>", "<span class='math-ltr'>A - B = B - A</span>", "<span class='math-ltr'>A - B = A</span>", "<span class='math-ltr'>A ∩ B = A</span>"],
                correct: 0,
                hint: "خاصیت جابجایی.",
                rationale: "اجتماع خاصیت جابجایی دارد."
            },
            {
                q: "اگر <span class='math-ltr'>n(A)=10</span>, <span class='math-ltr'>n(B)=8</span>, <span class='math-ltr'>n(A ∩ B)=3</span>، حاصل <span class='math-ltr'>n(A ∪ B)</span>؟",
                options: ["۱۵", "۱۸", "۲۱", "۱۱"],
                correct: 0,
                hint: "فرمول: <span class='math-ltr'>n(A) + n(B) - n(A ∩ B)</span>",
                rationale: "10 + 8 - 3 = 15."
            },
            {
                q: "متمم اجتماع دو مجموعه (<span class='math-ltr'>(A ∪ B)'</span>) برابر است با:",
                options: ["<span class='math-ltr'>A' ∩ B'</span>", "<span class='math-ltr'>A' ∪ B'</span>", "<span class='math-ltr'>A' - B'</span>", "<span class='math-ltr'>A ∩ B</span>"],
                correct: 0,
                hint: "قانون دمورگان.",
                rationale: "متمم اجتماع برابر اشتراک متمم‌هاست."
            },
            {
                q: "اگر <span class='math-ltr'>A = {1, 2}</span> و <span class='math-ltr'>B = {2, 3}</span> و <span class='math-ltr'>C = {3, 4}</span>، حاصل <span class='math-ltr'>(A ∪ B) - C</span>؟",
                options: ["<span class='math-ltr'>{1, 2}</span>", "<span class='math-ltr'>{1, 2, 3}</span>", "<span class='math-ltr'>{4}</span>", "<span class='math-ltr'>∅</span>"],
                correct: 0,
                hint: "اجتماع اول: {1, 2, 3}، سپس حذف C.",
                rationale: "عدد 3 حذف می‌شود. {1, 2} باقی می‌ماند."
            },
            {
                q: "کدام گزینه صحیح است؟",
                options: ["<span class='math-ltr'>Q ∩ Q' = ∅</span>", "<span class='math-ltr'>Q ∪ Q' = ∅</span>", "<span class='math-ltr'>Z - N = Z</span>", "<span class='math-ltr'>N ∩ Z = Z</span>"],
                correct: 0,
                hint: "اشتراک گویا و گنگ.",
                rationale: "اشتراک اعداد گویا و گنگ همیشه تهی است."
            },
            {
                q: "اگر <span class='math-ltr'>A ∩ B = A</span> باشد، آنگاه:",
                options: ["<span class='math-ltr'>A ⊆ B</span>", "<span class='math-ltr'>B ⊆ A</span>", "<span class='math-ltr'>A = B</span>", "<span class='math-ltr'>A = ∅</span>"],
                correct: 0,
                hint: "اشتراک برابر مجموعه کوچکتر است.",
                rationale: "پس A زیرمجموعه B است."
            },
            {
                q: "تعداد نواحی جداگانه در نمودار ون دو مجموعه متقاطع؟",
                options: ["۳", "۲", "۴", "۱"],
                correct: 0,
                hint: "فقط A، مشترک، فقط B.",
                rationale: "سه ناحیه: <span class='math-ltr'>A-B</span>, <span class='math-ltr'>A∩B</span>, <span class='math-ltr'>B-A</span>."
            },
            {
                q: "حاصل <span class='math-ltr'>A ∪ ∅</span> چیست؟",
                options: ["<span class='math-ltr'>A</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>U</span>", "نامشخص"],
                correct: 0,
                hint: "اجتماع با هیچ.",
                rationale: "خود مجموعه A."
            },
            {
                q: "حاصل <span class='math-ltr'>A ∩ U</span> (U مجموعه مرجع) چیست؟",
                options: ["<span class='math-ltr'>A</span>", "<span class='math-ltr'>U</span>", "<span class='math-ltr'>∅</span>", "<span class='math-ltr'>A'</span>"],
                correct: 0,
                hint: "اشتراک با مرجع.",
                rationale: "خود A."
            },
            {
                q: "اگر <span class='math-ltr'>A - B = ∅</span> باشد، آنگاه:",
                options: ["<span class='math-ltr'>A ⊆ B</span>", "<span class='math-ltr'>B ⊆ A</span>", "<span class='math-ltr'>A = ∅</span>", "<span class='math-ltr'>A ∩ B = ∅</span>"],
                correct: 0,
                hint: "تمام A حذف شده است.",
                rationale: "یعنی تمام اعضای A در B بوده‌اند."
            },
            {
                q: "مجموعه <span class='math-ltr'>A - (A - B)</span> برابر است با:",
                options: ["<span class='math-ltr'>A ∩ B</span>", "<span class='math-ltr'>A ∪ B</span>", "<span class='math-ltr'>B</span>", "<span class='math-ltr'>A</span>"],
                correct: 0,
                hint: "از A قسمت غیرمشترک را برداریم.",
                rationale: "قسمت مشترک باقی می‌ماند."
            },
            {
                q: "مجموعه <span class='math-ltr'>(A - B) ∪ (B - A)</span> چه نام دارد؟",
                options: ["تفاضل متقارن", "اجتماع کامل", "اشتراک محض", "متمم"],
                correct: 0,
                hint: "نام خاص در ریاضیات.",
                rationale: "تفاضل متقارن."
            },
            {
                q: "اگر <span class='math-ltr'>A</span> اعداد اول و <span class='math-ltr'>B</span> اعداد زوج باشد، <span class='math-ltr'>A ∩ B</span> چیست؟",
                options: ["<span class='math-ltr'>{2}</span>", "<span class='math-ltr'>{1}</span>", "<span class='math-ltr'>∅</span>", "بی‌نهایت"],
                correct: 0,
                hint: "تنها عدد اول زوج.",
                rationale: "فقط عدد ۲."
            },
            {
                q: "اگر <span class='math-ltr'>A ∪ B = ∅</span> باشد، آنگاه:",
                options: ["<span class='math-ltr'>A = ∅</span> و <span class='math-ltr'>B = ∅</span>", "<span class='math-ltr'>A = ∅</span> یا <span class='math-ltr'>B = ∅</span>", "<span class='math-ltr'>A = B</span>", "غیرممکن است"],
                correct: 0,
                hint: "اجتماع فقط زمانی تهی است که هر دو تهی باشند.",
                rationale: "هر دو باید تهی باشند."
            },

            // Lesson 4: Probability
            {
                q: "در پرتاب یک تاس، احتمال آمدن عدد زوج چقدر است؟",
                options: [frac("۱","۲"), frac("۱","۳"), frac("۱","۶"), frac("۲","۳")],
                correct: 0,
                hint: "اعداد زوج: ۲، ۴، ۶.",
                rationale: "۳ عدد از ۶ عدد. احتمال " + frac("۱","۲") + "."
            },
            {
                q: "در پرتاب دو سکه، احتمال اینکه «حداقل یک رو» بیاید؟",
                options: [frac("۳","۴"), frac("۱","۴"), frac("۱","۲"), "۱"],
                correct: 0,
                hint: "حالت (پشت، پشت) مطلوب نیست.",
                rationale: "۳ حالت از ۴ حالت مطلوب است."
            },
            {
                q: "احتمال عدد ۷ در پرتاب تاس؟",
                options: ["۰", "۱", frac("۱","۶"), frac("۷","۶")],
                correct: 0,
                hint: "پیشامد غیرممکن.",
                rationale: "صفر."
            },
            {
                q: "اگر <span class='math-ltr'>P(A) = 0.4</span>، احتمال رخ ندادن A چقدر است؟",
                options: ["۰/۶", "۰/۴", "۰", "۱"],
                correct: 0,
                hint: "۱ منهای احتمال وقوع.",
                rationale: "۱ - ۰/۴ = ۰/۶."
            },
            {
                q: "در پرتاب دو تاس، احتمال جفت آمدن (هر دو عدد یکسان)؟",
                options: [frac("۱","۶"), frac("۱","۳۶"), frac("۱","۱۲"), frac("۵","۳۶")],
                correct: 0,
                hint: "حالات: (۱,۱) تا (۶,۶).",
                rationale: "۶ حالت از ۳۶ حالت. " + frac("۶","۳۶") + " = " + frac("۱","۶") + "."
            },
            {
                q: "احتمال انتخاب مهره آبی از کیسه‌ای با ۳ آبی و ۲ قرمز؟",
                options: [frac("۳","۵"), frac("۲","۵"), frac("۱","۳"), frac("۱","۵")],
                correct: 0,
                hint: "تعداد آبی تقسیم بر کل.",
                rationale: "۳ از ۵."
            },
            {
                q: "احتمال اینکه روز تولد دو نفر در یک ماه باشد؟",
                options: [frac("۱","۱۲"), frac("۱","۳۶۵"), frac("۱","۳۰"), frac("۱","۲")],
                correct: 0,
                hint: "نفر دوم باید در ماه تولد نفر اول باشد.",
                rationale: "۱ از ۱۲."
            },
            {
                q: "اگر <span class='math-ltr'>n(S)=100</span> و <span class='math-ltr'>n(A)=25</span>، احتمال A؟",
                options: [frac("۱","۴"), frac("۱","۵"), frac("۱","۲"), frac("۳","۴")],
                correct: 0,
                hint: "ساده کردن کسر.",
                rationale: "۲۵/۱۰۰ = ۱/۴."
            },
            {
                q: "کدام عدد نمی‌تواند احتمال باشد؟",
                options: ["۱/۵", "۰/۵", "۱۵٪", "۰"],
                correct: 0,
                hint: "احتمال باید بین ۰ و ۱ باشد.",
                rationale: "۱/۵ بزرگتر از ۱ است."
            },
            {
                q: "احتمال اینکه تاس عدد اول یا زوج بیاید؟",
                options: [frac("۵","۶"), frac("۲","۳"), frac("۱","۲"), frac("۱","۶")],
                correct: 0,
                hint: "اعداد: ۲، ۳، ۵ (اول) و ۴، ۶ (زوج). ۲ مشترک.",
                rationale: "مجموعه {2, 3, 5, 4, 6}. ۵ عضو دارد. احتمال " + frac("۵","۶") + "."
            },
            {
                q: "خانواده‌ای ۲ فرزند دارد. احتمال اینکه حداقل یک پسر داشته باشد؟",
                options: [frac("۳","۴"), frac("۱","۴"), frac("۱","۲"), "۱"],
                correct: 0,
                hint: "فقط حالت (دختر، دختر) مطلوب نیست.",
                rationale: "۳ حالت از ۴ حالت."
            },
            {
                q: "در پرتاب سکه، احتمال رو آمدن؟",
                options: [frac("۱","۲"), frac("۱","۳"), "۵۰٪", "گزینه ۱ و ۳"],
                correct: 3,
                hint: "نصف حالات.",
                rationale: "هم کسر ۱/۲ و هم ۵۰٪ صحیح است."
            },
            {
                q: "احتمال انتخاب عدد اول از بین اعداد ۱ تا ۱۰؟",
                options: [frac("۲","۵"), frac("۱","۲"), frac("۳","۱۰"), frac("۱","۵")],
                correct: 0,
                hint: "اعداد اول: ۲، ۳، ۵، ۷.",
                rationale: "۴ عدد از ۱۰ عدد. " + frac("۴","۱۰") + " = " + frac("۲","۵") + "."
            },
            {
                q: "احتمال انتخاب عدد مربع کامل از ۱ تا ۲۰؟",
                options: [frac("۱","۵"), frac("۱","۴"), frac("۳","۲۰"), frac("۱","۱۰")],
                correct: 0,
                hint: "۱، ۴، ۹، ۱۶.",
                rationale: "۴ عدد از ۲۰ عدد. " + frac("۴","۲۰") + " = " + frac("۱","۵") + "."
            },
            {
                q: "در پرتاب دو تاس، مجموع اعداد حداکثر ۱۲ است. احتمال این پیشامد؟",
                options: ["۱", "۰", frac("۱۱","۱۲"), frac("۳۵","۳۶")],
                correct: 0,
                hint: "همیشه مجموع کمتر یا مساوی ۱۲ است.",
                rationale: "پیشامد حتمی است."
            },
            {
                q: "احتمال اینکه عقربه چرخنده روی رنگ سبز (از ۴ رنگ مساوی) بایستد؟",
                options: [frac("۱","۴"), frac("۱","۳"), "۲۵٪", "گزینه ۱ و ۳"],
                correct: 3,
                hint: "یک قسمت از چهار قسمت.",
                rationale: "۱/۴ معادل ۲۵٪ است."
            },
            {
                q: "احتمال انتخاب حرف 'م' از کلمه 'مدرسه'؟",
                options: [frac("۱","۵"), frac("۱","۴"), frac("۱","۶"), frac("۲","۵")],
                correct: 0,
                hint: "تعداد حروف ۵ تاست.",
                rationale: "یک حرف 'م' در ۵ حرف. " + frac("۱","۵") + "."
            },
            {
                q: "اگر احتمال برد ۰/۳ و باخت ۰/۴ باشد، احتمال مساوی؟",
                options: ["۰/۳", "۰/۴", "۰/۷", "۰/۱"],
                correct: 0,
                hint: "مجموع احتمالات باید ۱ شود.",
                rationale: "۱ - (۰/۳ + ۰/۴) = ۰/۳."
            },
            {
                q: "تعداد حالات پرتاب ۳ سکه؟",
                options: ["۸", "۶", "۹", "۳"],
                correct: 0,
                hint: "<span class='math-ltr'>2<sup>3</sup></span>",
                rationale: "۸ حالت."
            },
            {
                q: "احتمال اینکه تاس مضرب ۵ بیاید؟",
                options: [frac("۱","۶"), frac("۱","۵"), frac("۱","۳"), frac("۱","۲")],
                correct: 0,
                hint: "فقط عدد ۵ مضرب ۵ است.",
                rationale: "۱ عدد از ۶ عدد."
            },
            {
                q: "در کیسه‌ای ۱۰ مهره است. ۴ تا آبی. احتمال آبی نبودن؟",
                options: [frac("۳","۵"), frac("۲","۵"), frac("۴","۱۰"), frac("۱","۲")],
                correct: 0,
                hint: "۶ مهره آبی نیستند.",
                rationale: "۶ از ۱۰ می‌شود " + frac("۳","۵") + "."
            },
            {
                q: "احتمال انتخاب عدد زوج از بین ارقام ریاضی (۰ تا ۹)؟",
                options: [frac("۱","۲"), frac("۴","۱۰"), frac("۵","۹"), frac("۴","۹")],
                correct: 0,
                hint: "۰، ۲، ۴، ۶، ۸.",
                rationale: "۵ عدد از ۱۰ عدد. " + frac("۵","۱۰") + " = " + frac("۱","۲") + "."
            },
            {
                q: "احتمال اینکه مجموع دو تاس ۱ شود؟",
                options: ["۰", "۱", frac("۱","۳۶"), frac("۱","۶")],
                correct: 0,
                hint: "حداقل مجموع ۲ است (۱+۱).",
                rationale: "غیرممکن است."
            },
            {
                q: "اگر <span class='math-ltr'>P(A)=1</span> باشد، A چیست؟",
                options: ["فضای نمونه", "تهی", "زیرمجموعه", "نامشخص"],
                correct: 0,
                hint: "تمام حالات ممکن.",
                rationale: "برابر فضای نمونه S است."
            },
            {
                q: "احتمال آمدن شیر در پرتاب سکه؟",
                options: [frac("۱","۲"), frac("۱","۱"), "۰", frac("۱","۴")],
                correct: 0,
                hint: "یک رو از دو رو.",
                rationale: "۱/۲."
            },
            {
                q: "تعداد حالات پرتاب یک تاس و یک سکه؟",
                options: ["۱۲", "۸", "۶", "۳۶"],
                correct: 0,
                hint: "۶ ضربدر ۲.",
                rationale: "۱۲ حالت."
            },
            {
                q: "احتمال اینکه فرزند دوم دختر باشد (مستقل از اولی)؟",
                options: [frac("۱","۲"), frac("۱","۴"), frac("۳","۴"), frac("۱","۳")],
                correct: 0,
                hint: "جنسیت فرزندان مستقل است.",
                rationale: "همیشه ۱/۲ است."
            },
            {
                q: "احتمال انتخاب عدد صحیح از مجموعه اعداد طبیعی؟",
                options: ["۱", "۰", frac("۱","۲"), "نامشخص"],
                correct: 0,
                hint: "تمام اعداد طبیعی صحیح هستند.",
                rationale: "پیشامد حتمی است."
            },
            {
                q: "احتمال اینکه تاس عدد کوچکتر از ۷ بیاید؟",
                options: ["۱", "۰", frac("۵","۶"), frac("۱","۶")],
                correct: 0,
                hint: "همه اعداد تاس کوچکتر از ۷ هستند.",
                rationale: "حتمی است."
            },
            {
                q: "احتمال انتخاب مهره سفید از کیسه خالی؟",
                options: ["۰", "۱", "نامشخص", "بی‌نهایت"],
                correct: 0,
                hint: "هیچ مهره‌ای نیست.",
                rationale: "غیرممکن."
            },
            {
                q: "در پرتاب دو تاس، احتمال اینکه مجموع ۱۰ شود؟",
                options: [frac("۱","۱۲"), frac("۱","۳۶"), frac("۱","۹"), frac("۱","۱۸")],
                correct: 0,
                hint: "حالات: (۴,۶), (۵,۵), (۶,۴).",
                rationale: "۳ حالت از ۳۶. " + frac("۳","۳۶") + " = " + frac("۱","۱۲") + "."
            },
            {
                q: "احتمال اینکه عقربه روی ناحیه قرمز (۳۰ درجه از ۳۶۰) بایستد؟",
                options: [frac("۱","۱۲"), frac("۱","۶"), frac("۱","۴"), frac("۱","۳")],
                correct: 0,
                hint: "۳۰ تقسیم بر ۳۶۰.",
                rationale: "۱/۱۲."
            },
            {
                q: "احتمال انتخاب عدد بخش‌پذیر بر ۳ از تاس؟",
                options: [frac("۱","۳"), frac("۱","۲"), frac("۱","۶"), frac("۲","۳")],
                correct: 0,
                hint: "۳ و ۶.",
                rationale: "۲ از ۶ می‌شود ۱/۳."
            },
            {
                q: "مجموع احتمالات تمام پیشامدهای ساده یک آزمایش؟",
                options: ["۱", "۰", "۱۰۰", "نامشخص"],
                correct: 0,
                hint: "جمع کل شانس‌ها.",
                rationale: "همیشه برابر ۱ است."
            },
            {
                q: "احتمال اینکه فردا خورشید از شرق طلوع کند؟",
                options: ["۱", "۰", "۰/۵", "نامشخص"],
                correct: 0,
                hint: "واقعیت علمی ثابت.",
                rationale: "حتمی است."
            },
            {
                q: "در پرتاب ۳ سکه، احتمال ۳ خط؟",
                options: [frac("۱","۸"), frac("۱","۴"), frac("۳","۸"), frac("۱","۲")],
                correct: 0,
                hint: "فقط یک حالت (خ،خ،خ).",
                rationale: "۱ از ۸."
            },
            {
                q: "اگر احتمال بارش ۰/۲ باشد، احتمال عدم بارش؟",
                options: ["۰/۸", "۰/۲", "۱", "۰"],
                correct: 0,
                hint: "مکمل.",
                rationale: "۰/۸."
            },
            {
                q: "تعداد اعضای فضای نمونه پرتاب سکه و انتخاب روز هفته؟",
                options: ["۱۴", "۹", "۱۲", "۷"],
                correct: 0,
                hint: "۲ ضربدر ۷.",
                rationale: "۱۴ حالت."
            },
            {
                q: "احتمال اینکه عدد تاس گنگ باشد؟",
                options: ["۰", "۱", frac("۱","۲"), frac("۱","۶")],
                correct: 0,
                hint: "اعداد تاس طبیعی هستند.",
                rationale: "هیچ عدد گنگی روی تاس نیست."
            },
            {
                q: "احتمال انتخاب حرف 'آ' از 'ایران'؟",
                options: [frac("۱","۵"), frac("۲","۵"), frac("۱","۴"), frac("۳","۵")],
                correct: 0,
                hint: "الف و نون و... .",
                rationale: "یک 'الف' در ۵ حرف. ۱/۵."
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let userAnswers = [];
        let currentQuizQuestions = []; // Array to hold the selected 20 questions

        // --- Functions ---

        function toPersianNum(num) {
            const persian = ['۰', '۱', '۲', '۳', '۴', '۵', '۶', '۷', '۸', '۹'];
            return num.toString().replace(/[0-9]/g, x => persian[x]);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startQuiz() {
            // Reset state
            currentQuestion = 0;
            score = 0;
            userAnswers = new Array(20).fill(null);
            
            // Select 20 random questions from the pool
            const shuffledPool = shuffleArray([...questionPool]); // Copy and shuffle
            currentQuizQuestions = shuffledPool.slice(0, 20);

            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            loadQuestion();
        }

        function resetAndRestart() {
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('review-screen').classList.add('hidden');
            startQuiz();
        }

        function backToResult() {
            document.getElementById('review-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
        }

        function loadQuestion() {
            const q = currentQuizQuestions[currentQuestion];
            document.getElementById('current-q-num').innerText = toPersianNum(currentQuestion + 1);
            
            // Update progress bar
            document.getElementById('progress-bar').style.width = ((currentQuestion + 1) / 20) * 100 + '%';
            
            const container = document.getElementById('question-container');
            container.innerHTML = `
                <div class="question-card active">
                    <h3 class="text-xl font-bold text-slate-800 mb-8 leading-9">${q.q}</h3>
                    <div class="space-y-4">
                        ${q.options.map((opt, index) => `
                            <div onclick="selectOption(${index})" class="option-btn group ${userAnswers[currentQuestion] === index ? 'selected' : ''}" id="opt-${index}">
                                <div class="w-9 h-9 rounded-xl ${userAnswers[currentQuestion] === index ? 'bg-primary-main text-white border-primary-main' : 'bg-white text-slate-500 border-slate-200'} flex items-center justify-center ml-4 font-bold border transition-all group-hover:border-primary-light group-hover:text-primary-main shadow-sm">${toPersianNum(index + 1)}</div>
                                <span class="text-slate-700 font-medium group-hover:text-primary-dark transition-colors">${opt}</span>
                            </div>
                        `).join('')}
                    </div>
                    <div id="hint-box" class="hint-box">
                        <strong class="block mb-2 text-amber-600 flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            راهنمای حل:
                        </strong> 
                        ${q.hint}
                    </div>
                </div>
            `;
            
            document.getElementById('prev-btn').disabled = (currentQuestion === 0);
            
            const isAnswered = userAnswers[currentQuestion] !== null;
            document.getElementById('next-btn').disabled = !isAnswered;
            document.getElementById('next-btn').innerText = (currentQuestion === 19) ? "پایان آزمون" : "سؤال بعدی";
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                loadQuestion();
            }
        }

        function selectOption(index) {
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.classList.remove('selected');
                btn.querySelector('div').classList.remove('bg-primary-main', 'text-white', 'border-primary-main');
                btn.querySelector('div').classList.add('bg-white', 'text-slate-500', 'border-slate-200');
            });
            const selectedBtn = document.getElementById(`opt-${index}`);
            selectedBtn.classList.add('selected');
            const numBadge = selectedBtn.querySelector('div');
            numBadge.classList.remove('bg-white', 'text-slate-500', 'border-slate-200');
            numBadge.classList.add('bg-primary-main', 'text-white', 'border-primary-main');
            
            userAnswers[currentQuestion] = index;
            document.getElementById('next-btn').disabled = false;
        }

        function toggleHint() {
            const box = document.getElementById('hint-box');
            box.style.display = (box.style.display === 'block') ? 'none' : 'block';
        }

        function nextQuestion() {
            if (currentQuestion < 19) {
                currentQuestion++;
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            score = 0;
            userAnswers.forEach((ans, idx) => {
                if (ans === currentQuizQuestions[idx].correct) score++;
            });

            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            
            document.getElementById('final-score').innerText = `${toPersianNum(score)} / ${toPersianNum(20)}`;
            
            const msg = document.getElementById('score-msg');
            const icon = document.getElementById('score-icon');
            
            if (score >= 18) {
                msg.innerText = "فوق‌العاده! تسلط شما بر فصل اول عالی است.";
                msg.className = "text-emerald-600 mb-10 text-xl font-bold";
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" class="text-emerald-500" />';
            } else if (score >= 12) {
                msg.innerText = "خوب است! اما نیاز به تمرین بیشتر در برخی مباحث دارید.";
                msg.className = "text-amber-500 mb-10 text-xl font-bold";
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" class="text-amber-500" />';
            } else {
                msg.innerText = "نیاز به تلاش بیشتر. پیشنهاد می‌کنیم جزوه را مجدد مطالعه کنید.";
                msg.className = "text-red-500 mb-10 text-xl font-bold";
                icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" class="text-red-500" />';
            }
        }

        function showReview() {
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('review-screen').classList.remove('hidden');
            
            const container = document.getElementById('review-container');
            container.innerHTML = currentQuizQuestions.map((q, idx) => {
                const userAns = userAnswers[idx];
                const isCorrect = userAns === q.correct;
                const statusBadge = isCorrect 
                    ? `<span class="badge badge-correct">درست</span>` 
                    : `<span class="badge badge-wrong">نادرست</span>`;
                
                return `
                    <div class="review-item border-r-4 ${isCorrect ? 'border-r-emerald-400' : 'border-r-red-400'}">
                        <div class="flex items-start justify-between mb-4">
                            <h4 class="font-bold text-slate-800 text-lg leading-8 w-full pl-4">
                                <span class="text-slate-400 ml-2 text-sm bg-slate-100 px-2 py-1 rounded-md">سؤال ${toPersianNum(idx + 1)}</span>
                                ${q.q}
                            </h4>
                            <div class="shrink-0">${statusBadge}</div>
                        </div>
                        
                        <div class="grid gap-3 mb-5">
                            ${q.options.map((opt, optIdx) => {
                                let classes = "p-3 rounded-xl border text-sm flex items-center transition-colors ";
                                let icon = "";
                                
                                if (optIdx === q.correct) {
                                    classes += "bg-emerald-50 border-emerald-200 text-emerald-800 font-bold"; // Correct Answer
                                    icon = `<svg class="w-5 h-5 mr-auto text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>`;
                                }
                                else if (optIdx === userAns && !isCorrect) {
                                    classes += "bg-red-50 border-red-200 text-red-800"; // User Wrong Answer
                                    icon = `<svg class="w-5 h-5 mr-auto text-red-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>`;
                                }
                                else {
                                    classes += "bg-white border-slate-100 text-slate-400 opacity-60"; // Normal
                                }
                                
                                return `<div class="${classes}">
                                            <span class="ml-2 w-6 h-6 rounded-full bg-white/60 flex items-center justify-center text-xs border border-current opacity-80">${toPersianNum(optIdx + 1)}</span>
                                            ${opt}
                                            ${icon}
                                        </div>`;
                            }).join('')}
                        </div>

                        <div class="bg-indigo-50 p-5 rounded-2xl text-sm text-indigo-900 leading-7 border border-indigo-100 flex gap-3">
                            <div class="shrink-0 pt-1 text-indigo-500">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                            </div>
                            <div>
                                <strong class="text-indigo-700 block mb-1">توضیحات:</strong>
                                ${q.rationale}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

    </script>
</body>
</html>